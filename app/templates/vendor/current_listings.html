{% extends 'layouts/listings.html' %}
{% import 'macros/form_macros.html' as f %}

{% macro make_guider() %}
<script type="text/javascript">

    guiders.createGuider({
      attachTo: "#filter_form",

      buttons: [
                {name: "Next"}],
      description: "Go ahead and check it out!.",
      highlight: true,
      id: "first_form",
      next: "second_search",
      title: "Here you can search and filter through all of your current listings.",
      width: 400,
      position: 5,
    }).show();

    guiders.createGuider({
      attachTo: "#search",
      buttons: [{
                  name: "Custom Button",
                  onclick: function() { alert("Hello!"); }
                },
                {name: "Next"}],
      description: "Or even its description",
      highlight: true,
      id: "second_search",
      next: "third_avail",
      overlay: true,
      title: "You can search by the item name.",
      width: 300,
      position: 5,
      arrowSize:20
    });

      guiders.createGuider({
      attachTo: "#availability",
      buttons: [{
                  name: "Ok, enough already- let me check this out",
                  onclick: function() { guiders.hideAll(); }
                },
                {name: "Next"}],
      description: "Or sort by its price and name",
      overlay: true,
      highlight: true,
      id: "third_avail",
      next: "fourth_filter",
      title: "You can toggle whether the item is available.",
      width: 300,
      position: 5,
    });



</script>
{% endmacro %}


{% block before %}
    {% set flashes = {
        'error':   get_flashed_messages(category_filter=['form-error']),
        'warning': get_flashed_messages(category_filter=['form-check-email']),
        'info':    get_flashed_messages(category_filter=['form-info']),
        'success': get_flashed_messages(category_filter=['form-success'])
     } %}

    <a class="ui basic compact button" href="{{ url_for('vendor.index') }}">
        <i class="caret left icon"></i>
        Back to dashboard
    </a>
    <h2 class="ui header">
        Your Items
        <div class="sub header">
            View and manage all your items.
        </div>
    </h2>

    <form id="filter_form" class="ui form segment">
        <div class="twelve wide field">
            <label id="label_form">Search names and descriptions</label>
            <input id ="search" value="{{ main_search_term }}" type="text" name="main-search" placeholder="e.g. corned beef">
        </div>

        <div id="availability" class="inline field">
            <select  class="ui selection dropdown" name="avail">
                {% if request.args.get('avail') == "avail" %}
                    {% set selected = 'selected' %}
                {% elif request.args.get('avail') == "non_avail" %}
                    {% set selected2 = 'selected' %}
                {% elif request.args.get('avail') == "avail" %}
                    {% set selected3 = 'selected' %}
                {% endif %}
                <option value="both" {{ selected }}>Show Available and Non Available Items</option>
                <option value="non_avail" {{ selected2 }}>Show Non Available Items</option>
                <option value="avail" {{ selected3 }}>Show Available Items</option>

            </select>
            <br>
            <br>
            <select class="ui selection dropdown" name="sort-by">
                {% if request.args.get('sortby') == "low_high" %}
                    {% set checked2 = 'selected' %}
                {% elif request.args.get('sortby') == "high_low" %}
                    {% set checked3 = 'selected' %}
                {% elif request.args.get('sortby') == "alphaAZ" %}
                    {% set checked4 = 'selected' %}
                {% elif request.args.get('sortby') == "alphaZA" %}
                    {% set checked5 = 'selected' %}
                {% endif %}
                <option value="low_high" {{ checked2 }}>Price, low to high</option>
                <option value="high_low" {{ checked3 }}>Price, high to low</option>
                <option value="alphaAZ" {{ checked4 }}>Alphabetical names, (A-Z)</option>
                <option value="alphaZA" {{ checked5 }}>Alphabetical names, (Z-A)</option>

            </select>

        </div>

        {% if not name_search_term and not min_price and not max_price%}
            {% set display = 'display:none' %}
        {% endif %}
        <br>
        <button id="filterer" class="ui button blue" type="submit">Search</button>
        <a class="ui button" href="{{ url_for('vendor.current_listings', page=1) }}">Clear Criteria</a>
    </form>
{% endblock %}

{% block after %}
{{ make_guider() }}
{% endblock %}
