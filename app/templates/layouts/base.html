{% import 'macros/nav_macros.html' as nav %}

<!DOCTYPE html>
<html>
    {% include 'partials/_head.html' %}

    <body>
        {% block nav %}
            {{ nav.render_nav(current_user) }}
        {% endblock %}

        {% include 'partials/_flashes.html' %}

        {% block content %}
        {% endblock %}

        {# Implement CSRF protection for site #}
        {% if csrf_token() %}
            <div style="visibility: hidden; display: none">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            </div>

            <script>
                $.ajaxSetup({
                    beforeSend: function(xhr, settings) {
                        if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                            xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token() }}")
                        }
                    }
                });
            </script>
        {% endif %}
    </body>
</html>
